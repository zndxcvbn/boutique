<UserControl x:Class="Boutique.Views.DistributionCreateTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:Boutique.ViewModels"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance vm:DistributionEditTabViewModel, IsDesignTimeCreatable=False}"
             x:Name="Root"
             d:DesignHeight="600"
             d:DesignWidth="1100">
    <UserControl.Resources>
        <!-- Reusable Filter Chip Template -->
        <DataTemplate x:Key="FilterChipTemplate">
            <Border Style="{StaticResource FilterChipStyle}">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="{Binding DisplayName}" FontSize="11" VerticalAlignment="Center" />
                    <TextBlock Text="{Binding FormKeyString}" Style="{StaticResource FormKeyTextStyle}" Margin="4,0,0,0" FontSize="9" />
                    <Button Style="{StaticResource InlineRemoveButtonStyle}" Tag="{Binding}" Margin="3,0,0,0" />
                </StackPanel>
            </Border>
        </DataTemplate>

        <!-- Reusable Search/Filter Tab Content -->
        <DataTemplate x:Key="FilterDataGridTemplate">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                    <TextBlock Text="Search:" Style="{StaticResource LabelTextStyle}" />
                    <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" MinWidth="200" />
                </StackPanel>
            </Grid>
        </DataTemplate>
    </UserControl.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" />
            <ColumnDefinition Width="10" />
            <ColumnDefinition Width="3*" />
        </Grid.ColumnDefinitions>

        <!-- Distribution Entries Editor -->
        <GroupBox Grid.Column="0" Header="Distribution Entries" Padding="6">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <!-- File Selector -->
                <StackPanel Grid.Row="0" Margin="0,0,0,6">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                        <TextBlock Text="File:" Style="{StaticResource LabelTextStyle}" />
                        <ComboBox ItemsSource="{Binding AvailableDistributionFiles}"
                                  SelectedItem="{Binding SelectedDistributionFile, Mode=TwoWay}"
                                  DisplayMemberPath="DisplayName"
                                  MinWidth="250" Margin="0,0,6,0" />
                        <TextBlock Text="Format:" Style="{StaticResource LabelTextStyle}" Margin="12,0,6,0" />
                        <ComboBox ItemsSource="{Binding AvailableFormats}"
                                  SelectedItem="{Binding DistributionFormat, Mode=TwoWay}"
                                  MinWidth="120" Margin="0,0,6,0">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Converter={StaticResource DistributionFileTypeConverter}}" />
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Visibility="{Binding ShowNewFileNameInput, Converter={StaticResource BoolToVisConverter}}">
                        <TextBlock Text="Filename:" Style="{StaticResource LabelTextStyle}" />
                        <TextBox Text="{Binding NewFileName, UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center" MinWidth="200" Margin="0,0,6,0" />
                        <Button Content="Browse..." Command="{Binding SelectDistributionFilePathCommand}" Padding="8,2" />
                    </StackPanel>
                    <!-- Conflict Warning -->
                    <Border Style="{StaticResource WarningPanelStyle}" Margin="0,6,0,0"
                            Visibility="{Binding HasConflicts, Converter={StaticResource BoolToVisConverter}}">
                        <StackPanel>
                            <TextBlock Text="{Binding ConflictSummary}" TextWrapping="Wrap" Foreground="#CC6600" FontSize="11" />
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Suggested: " Foreground="#CC6600" FontWeight="Bold" FontSize="11" />
                                <TextBlock Text="{Binding SuggestedFileName}" Foreground="#CC6600" FontFamily="Consolas" FontWeight="Bold" FontSize="11" />
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>

                <!-- Action Buttons -->
                <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,6">
                    <Button Content="Add Entry" Command="{Binding AddDistributionEntryCommand}" Margin="0,0,6,0" Padding="8,2" />
                    <Button Content="Load File" Command="{Binding LoadDistributionFileCommand}" Margin="0,0,6,0" Padding="8,2" />
                    <Button Content="Save File" Command="{Binding SaveDistributionFileCommand}" Margin="0,0,6,0" Padding="8,2" />
                    <Button Content="ðŸ“‹ Paste Filter" Command="{Binding PasteFilterToEntryCommand}" Padding="8,2"
                            ToolTip="{Binding CopiedFilter.Description, StringFormat='Paste filter: {0}', FallbackValue='Paste copied filter from NPCs tab'}" />
                </StackPanel>

                <!-- Distribution Entries List -->
                <ListBox Grid.Row="2" ItemsSource="{Binding DistributionEntries}"
                         VirtualizingPanel.IsVirtualizing="True"
                         VirtualizingPanel.VirtualizationMode="Recycling"
                         VirtualizingPanel.ScrollUnit="Pixel"
                         ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                         Background="Transparent" BorderThickness="0"
                         HorizontalContentAlignment="Stretch"
                         ItemContainerStyle="{StaticResource PlainListBoxItemStyle}">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border Style="{StaticResource SelectableEntryStyle}">
                                <Border.Resources>
                                    <Style TargetType="Border" BasedOn="{StaticResource SelectableEntryStyle}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                                <Setter Property="Background" Value="{StaticResource Brush.CardBackground}" />
                                                <Setter Property="BorderBrush" Value="{StaticResource Brush.Accent}" />
                                                <Setter Property="BorderThickness" Value="2" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Resources>
                                <StackPanel>
                                    <!-- Header: Assign + Outfit + Chance + Preview + Remove -->
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                                        <RadioButton Content="Assign" IsChecked="{Binding IsSelected}"
                                                     Command="{Binding DataContext.SelectEntryCommand, ElementName=Root}"
                                                     CommandParameter="{Binding}" Margin="0,0,8,0" FontWeight="Bold" VerticalAlignment="Center" />
                                        <TextBlock Text="Outfit:" VerticalAlignment="Center" Margin="0,0,4,0" />
                                        <ComboBox ItemsSource="{Binding DataContext.AvailableOutfits, ElementName=Root}"
                                                  SelectedItem="{Binding SelectedOutfit, Mode=TwoWay}"
                                                  DisplayMemberPath="EditorID" MinWidth="140" Margin="0,0,4,0" Height="22"
                                                  MaxDropDownHeight="300" IsEditable="True" IsTextSearchEnabled="True"
                                                  TextSearch.TextPath="EditorID" DropDownOpened="ComboBox_DropDownOpened"
                                                  VerticalContentAlignment="Center" />
                                        <CheckBox Content="%" IsChecked="{Binding UseChance, Mode=TwoWay}" VerticalAlignment="Center" Margin="0,0,2,0" ToolTip="Use Chance" />
                                        <TextBox Text="{Binding Chance, UpdateSourceTrigger=PropertyChanged}" Width="32" Height="22"
                                                 IsEnabled="{Binding UseChance}" Margin="0,0,4,0" ToolTip="Chance (0-100)"
                                                 VerticalAlignment="Center" VerticalContentAlignment="Center" Padding="2,0" />
                                        <Button ToolTip="Preview Outfit" Style="{StaticResource IconButtonStyle}"
                                                Command="{Binding DataContext.PreviewEntryCommand, ElementName=Root}" CommandParameter="{Binding}">
                                            <Image Source="pack://application:,,,/Assets/eye.png" Width="12" Height="12" />
                                        </Button>
                                        <Button Command="{Binding RemoveCommand}" Style="{StaticResource InlineRemoveButtonStyle}"
                                                ToolTip="Remove Entry" Height="22" Width="22" Margin="2,0,0,0" />
                                    </StackPanel>

                                    <!-- NPCs (hidden when empty) -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0"
                                                Visibility="{Binding SelectedNpcs.Count, Converter={StaticResource CollectionCountToVisConverter}}">
                                        <TextBlock Text="NPCs:" Style="{StaticResource SecondaryTextStyle}" Margin="0,0,4,0" FontSize="11" />
                                        <ItemsControl ItemsSource="{Binding SelectedNpcs}" VerticalAlignment="Center">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate><StackPanel /></ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Style="{StaticResource FilterChipStyle}">
                                                        <StackPanel Orientation="Horizontal">
                                                            <TextBlock Text="{Binding DisplayName}" FontSize="11" VerticalAlignment="Center" />
                                                            <TextBlock Text="{Binding FormKeyString}" Style="{StaticResource FormKeyTextStyle}" Margin="4,0,0,0" FontSize="9" />
                                                            <Button Click="RemoveNpc_Click" Tag="{Binding}"
                                                                    Style="{StaticResource InlineRemoveButtonStyle}" Margin="3,0,0,0" />
                                                        </StackPanel>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>

                                    <!-- Factions (hidden when empty) -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0"
                                                Visibility="{Binding SelectedFactions.Count, Converter={StaticResource CollectionCountToVisConverter}}">
                                        <TextBlock Text="Factions:" Style="{StaticResource SecondaryTextStyle}" Margin="0,0,4,0" FontSize="11" />
                                        <ItemsControl ItemsSource="{Binding SelectedFactions}" VerticalAlignment="Center">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate><StackPanel /></ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Style="{StaticResource FilterChipStyle}">
                                                        <StackPanel Orientation="Horizontal">
                                                            <TextBlock Text="{Binding DisplayName}" FontSize="11" VerticalAlignment="Center" />
                                                            <TextBlock Text="{Binding FormKeyString}" Style="{StaticResource FormKeyTextStyle}" Margin="4,0,0,0" FontSize="9" />
                                                            <Button Click="RemoveFaction_Click" Tag="{Binding}"
                                                                    Style="{StaticResource InlineRemoveButtonStyle}" Margin="3,0,0,0" />
                                                        </StackPanel>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>

                                    <!-- Keywords (hidden when empty) -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0"
                                                Visibility="{Binding SelectedKeywords.Count, Converter={StaticResource CollectionCountToVisConverter}}">
                                        <TextBlock Text="Keywords:" Style="{StaticResource SecondaryTextStyle}" Margin="0,0,4,0" FontSize="11" />
                                        <ItemsControl ItemsSource="{Binding SelectedKeywords}" VerticalAlignment="Center">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate><StackPanel /></ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Style="{StaticResource FilterChipStyle}">
                                                        <StackPanel Orientation="Horizontal">
                                                            <TextBlock Text="{Binding DisplayName}" FontSize="11" VerticalAlignment="Center" />
                                                            <TextBlock Text="{Binding FormKeyString}" Style="{StaticResource FormKeyTextStyle}" Margin="4,0,0,0" FontSize="9" />
                                                            <Button Click="RemoveKeyword_Click" Tag="{Binding}"
                                                                    Style="{StaticResource InlineRemoveButtonStyle}" Margin="3,0,0,0" />
                                                        </StackPanel>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>

                                    <!-- Races (hidden when empty) -->
                                    <StackPanel Orientation="Horizontal" Margin="0,2,0,0"
                                                Visibility="{Binding SelectedRaces.Count, Converter={StaticResource CollectionCountToVisConverter}}">
                                        <TextBlock Text="Races:" Style="{StaticResource SecondaryTextStyle}" Margin="0,0,4,0" FontSize="11" />
                                        <ItemsControl ItemsSource="{Binding SelectedRaces}" VerticalAlignment="Center">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate><StackPanel /></ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <Border Style="{StaticResource FilterChipStyle}">
                                                        <StackPanel Orientation="Horizontal">
                                                            <TextBlock Text="{Binding DisplayName}" FontSize="11" VerticalAlignment="Center" />
                                                            <TextBlock Text="{Binding FormKeyString}" Style="{StaticResource FormKeyTextStyle}" Margin="4,0,0,0" FontSize="9" />
                                                            <Button Click="RemoveRace_Click" Tag="{Binding}"
                                                                    Style="{StaticResource InlineRemoveButtonStyle}" Margin="3,0,0,0" />
                                                        </StackPanel>
                                                    </Border>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>
                                    </StackPanel>

                                    <!-- Traits: Gender, Unique -->
                                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                        <TextBlock Text="Traits:" Style="{StaticResource SecondaryTextStyle}" Margin="0,0,6,0" FontSize="11" />
                                        <TextBlock Text="Gender:" VerticalAlignment="Center" Margin="0,0,4,0" FontSize="11" />
                                        <ComboBox ItemsSource="{x:Static vm:DistributionEntryViewModel.GenderOptions}"
                                                  SelectedItem="{Binding Gender, Mode=TwoWay}"
                                                  MinWidth="70" Height="22" FontSize="11" VerticalContentAlignment="Center" Margin="0,0,12,0" />
                                        <TextBlock Text="Unique:" VerticalAlignment="Center" Margin="0,0,4,0" FontSize="11" />
                                        <ComboBox ItemsSource="{x:Static vm:DistributionEntryViewModel.UniqueOptions}"
                                                  SelectedItem="{Binding Unique, Mode=TwoWay}"
                                                  MinWidth="100" Height="22" FontSize="11" VerticalContentAlignment="Center" />
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <!-- Preview (Collapsible) -->
                <Expander Grid.Row="3" Header="File Preview" IsExpanded="{Binding IsFilePreviewExpanded, Mode=TwoWay}" Margin="0,6,0,0">
                    <Border Padding="6" Background="{StaticResource Brush.CardBackground}"
                            BorderBrush="{StaticResource Brush.Border}" BorderThickness="1" CornerRadius="0,0,4,4">
                        <TextBox Text="{Binding DistributionPreviewText, Mode=OneWay}" IsReadOnly="True" TextWrapping="Wrap" AcceptsReturn="True"
                                 VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto" FontFamily="Consolas" FontSize="11" MinHeight="120" MaxHeight="200" />
                    </Border>
                </Expander>
            </Grid>
        </GroupBox>

        <!-- Filter Selection -->
        <GroupBox Grid.Column="2" Header="Distribution Filters" Padding="6">
            <TabControl>
                <!-- NPCs Tab -->
                <TabItem Header="NPCs">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Search:" Style="{StaticResource LabelTextStyle}" />
                            <TextBox Text="{Binding NpcSearchText, UpdateSourceTrigger=PropertyChanged}" MinWidth="200" />
                        </StackPanel>
                        <DataGrid Grid.Row="1" ItemsSource="{Binding FilteredNpcs}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False"
                                  CanUserSortColumns="True" SelectionMode="Single" EnableRowVirtualization="True" EnableColumnVirtualization="True">
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="" Binding="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                <DataGridTextColumn Header="Name" Binding="{Binding DisplayName}" Width="*" IsReadOnly="True" />
                                <DataGridTextColumn Header="EditorID" Binding="{Binding EditorID}" Width="200" IsReadOnly="True" />
                                <DataGridTextColumn Header="FormKey" Binding="{Binding FormKeyString}" Width="150" IsReadOnly="True"
                                                    ElementStyle="{StaticResource DataGridFormKeyColumnStyle}" />
                                <DataGridTextColumn Header="Mod" Binding="{Binding ModDisplayName}" Width="150" IsReadOnly="True"
                                                    ElementStyle="{StaticResource DataGridSecondaryColumnStyle}" />
                            </DataGrid.Columns>
                        </DataGrid>
                        <StackPanel Grid.Row="2" Margin="0,6,0,0">
                            <TextBlock Text="{Binding SelectedEntry.SelectedOutfit.EditorID, StringFormat='Target Entry: {0}', FallbackValue='Target Entry: (None selected)'}"
                                       FontStyle="Italic" Foreground="Gray" Margin="0,0,0,4" />
                            <Button Content="Add Selected NPCs to Entry" Command="{Binding AddSelectedNpcsToEntryCommand}" Padding="8,2" />
                        </StackPanel>
                    </Grid>
                </TabItem>

                <!-- Factions Tab -->
                <TabItem Header="Factions">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Search:" Style="{StaticResource LabelTextStyle}" />
                            <TextBox Text="{Binding FactionSearchText, UpdateSourceTrigger=PropertyChanged}" MinWidth="200" />
                        </StackPanel>
                        <DataGrid Grid.Row="1" ItemsSource="{Binding FilteredFactions}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False"
                                  EnableRowVirtualization="True" EnableColumnVirtualization="True">
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="" Binding="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                <DataGridTextColumn Header="Name" Binding="{Binding DisplayName}" Width="*" IsReadOnly="True" />
                                <DataGridTextColumn Header="EditorID" Binding="{Binding EditorID}" Width="200" IsReadOnly="True" />
                                <DataGridTextColumn Header="FormKey" Binding="{Binding FormKeyString}" Width="150" IsReadOnly="True"
                                                    ElementStyle="{StaticResource DataGridFormKeyColumnStyle}" />
                            </DataGrid.Columns>
                        </DataGrid>
                        <Button Grid.Row="2" Content="Add Selected Factions to Entry" Command="{Binding AddSelectedFactionsToEntryCommand}" Padding="8,2" Margin="0,6,0,0" />
                    </Grid>
                </TabItem>

                <!-- Keywords Tab -->
                <TabItem Header="Keywords">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Search:" Style="{StaticResource LabelTextStyle}" />
                            <TextBox Text="{Binding KeywordSearchText, UpdateSourceTrigger=PropertyChanged}" MinWidth="200" />
                        </StackPanel>
                        <DataGrid Grid.Row="1" ItemsSource="{Binding FilteredKeywords}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False"
                                  EnableRowVirtualization="True" EnableColumnVirtualization="True">
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="" Binding="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                <DataGridTextColumn Header="EditorID" Binding="{Binding EditorID}" Width="*" IsReadOnly="True" />
                                <DataGridTextColumn Header="FormKey" Binding="{Binding FormKeyString}" Width="150" IsReadOnly="True"
                                                    ElementStyle="{StaticResource DataGridFormKeyColumnStyle}" />
                            </DataGrid.Columns>
                        </DataGrid>
                        <Button Grid.Row="2" Content="Add Selected Keywords to Entry" Command="{Binding AddSelectedKeywordsToEntryCommand}" Padding="8,2" Margin="0,6,0,0" />
                    </Grid>
                </TabItem>

                <!-- Races Tab -->
                <TabItem Header="Races">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Search:" Style="{StaticResource LabelTextStyle}" />
                            <TextBox Text="{Binding RaceSearchText, UpdateSourceTrigger=PropertyChanged}" MinWidth="200" />
                        </StackPanel>
                        <DataGrid Grid.Row="1" ItemsSource="{Binding FilteredRaces}" AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False"
                                  EnableRowVirtualization="True" EnableColumnVirtualization="True">
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn Header="" Binding="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Width="Auto" />
                                <DataGridTextColumn Header="Name" Binding="{Binding DisplayName}" Width="*" IsReadOnly="True" />
                                <DataGridTextColumn Header="EditorID" Binding="{Binding EditorID}" Width="200" IsReadOnly="True" />
                                <DataGridTextColumn Header="FormKey" Binding="{Binding FormKeyString}" Width="150" IsReadOnly="True"
                                                    ElementStyle="{StaticResource DataGridFormKeyColumnStyle}" />
                            </DataGrid.Columns>
                        </DataGrid>
                        <Button Grid.Row="2" Content="Add Selected Races to Entry" Command="{Binding AddSelectedRacesToEntryCommand}" Padding="8,2" Margin="0,6,0,0" />
                    </Grid>
                </TabItem>
            </TabControl>
        </GroupBox>
    </Grid>
</UserControl>
