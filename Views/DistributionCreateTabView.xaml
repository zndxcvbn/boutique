<UserControl x:Class="Boutique.Views.DistributionCreateTabView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="clr-namespace:Boutique.ViewModels"
             xmlns:views="clr-namespace:Boutique.Views"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance vm:DistributionEditTabViewModel, IsDesignTimeCreatable=False}"
             d:DesignHeight="700"
             d:DesignWidth="1200">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*" MinWidth="300" />
            <ColumnDefinition Width="5" />
            <ColumnDefinition Width="3*" MinWidth="400" />
        </Grid.ColumnDefinitions>

        <!-- LEFT COLUMN: Entry List + File Preview (independent vertical split) -->
        <Grid Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" MinHeight="150" />
                <RowDefinition Height="5" />
                <RowDefinition Height="*" MinHeight="120" />
            </Grid.RowDefinitions>

            <!-- TOP-LEFT: Entry List -->
            <views:DistributionEntryListView Grid.Row="0" DataContext="{Binding}" />

            <!-- Left column horizontal splitter -->
            <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" Background="Transparent" />

            <!-- BOTTOM-LEFT: File Preview -->
            <views:DistributionFilePreviewView Grid.Row="2" DataContext="{Binding}" />
        </Grid>

        <!-- Vertical GridSplitter between columns -->
        <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Background="Transparent" />

        <!-- RIGHT COLUMN: Entry Editor + Filters (independent vertical split) -->
        <Grid Grid.Column="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="*" MinHeight="150" />
                <RowDefinition Height="5" />
                <RowDefinition Height="*" MinHeight="150" />
            </Grid.RowDefinitions>

            <!-- TOP-RIGHT: Entry Editor -->
            <views:DistributionEntryEditorView Grid.Row="0" DataContext="{Binding}" />

            <!-- Right column horizontal splitter -->
            <GridSplitter Grid.Row="1" Height="5" HorizontalAlignment="Stretch" Background="Transparent" />

            <!-- BOTTOM-RIGHT: Distribution Filters -->
            <views:DistributionFilterTabsView Grid.Row="2" DataContext="{Binding}" />
        </Grid>

        <!-- Loading Overlay -->
        <Border Grid.ColumnSpan="3"
                Background="#AA000000"
                Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisConverter}}"
                Panel.ZIndex="100">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200" Height="20" Margin="0,0,0,12" />
                <TextBlock Text="{Binding StatusMessage}"
                           Foreground="White"
                           FontSize="14"
                           HorizontalAlignment="Center" />
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
